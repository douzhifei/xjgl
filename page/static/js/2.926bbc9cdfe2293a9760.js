webpackJsonp([2],{"1alW":function(t,a,e){var i=e("kM2E");i(i.S,"Number",{isInteger:e("AKgy")})},"93yl":function(t,a){},"9gHt":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("RRo+"),n=e.n(i),s=(e("//Fk"),e("aozt")),o=e.n(s);var l=e("qwAB"),d={data:function(){return{content:"输入内容",imageUrl:"",domain:"http://up-z2.qiniup.com",qiniuaddr:"pb2s3qp87.bkt.clouddn.com",data:{}}},props:{udata:{type:Object,default:{}}},created:function(){this.data.content=this.content,console.log(this.udata),this.data=this.udata},mounted:function(){},methods:{upqiniu:function(t){var a=this,e={headers:{"Content-Type":"multipart/form-data"}},i="";i="image/png"===t.file.type?"png":"image/jpeg"===t.file.type?"jpg":"gif";var n="xjgl"+(new Date).getTime()+Math.floor(100*Math.random())+"."+i;o.a.get("/getToken").then(function(i){var s=new FormData;s.append("file",t.file),s.append("token",i.data),s.append("key",n),o.a.post(a.domain,s,e).then(function(t){a.imageUrl="http://"+a.qiniuaddr+"/"+t.data.key,a.data.cover=a.imageUrl})})},beforeUpload:function(t){var a="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type,e=t.size/1024/1024<5;return a||this.$message.error("上传图片只能是 JPG 格式!"),e||this.$message.error("上传图片大小不能超过 5MB!"),a&&e},updateData:function(t){this.data.content=t},quit:function(){this.$emit("quit")},submit:function(){this.data.banner=parseInt(this.data.banner),this.data.type=parseInt(this.data.type),this.data.top=parseInt(this.data.top),console.log(this.data),""!==this.data.title&&""!==this.data.goto&&n()(this.data.banner)&&n()(this.data.type)&&n()(this.data.top)?(this.data.goto=this.data.goto.trim(),this.$emit("submit",this.data)):this.$message("不能有空值！")}},components:{Scroll:l.a}},r={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"article"},[e("div",[e("div",{staticClass:"head"},[e("div",{staticClass:"head-left",on:{click:t.quit}},[t._v("关闭")]),t._v(" "),e("div",{staticClass:"head-center"},[t._v("文章编辑")]),t._v(" "),e("div",{staticClass:"head-right",on:{"&click":function(a){return t.submit(a)}}},[t._v("提交")])]),t._v(" "),e("div",{staticClass:"a-item a-title"},[t._v("标题："),e("el-input",{staticClass:"a-input",attrs:{type:"text",placeholder:"输入标题"},model:{value:t.data.title,callback:function(a){t.$set(t.data,"title",a)},expression:"data.title"}})],1),t._v(" "),e("div",{staticClass:"a-item a-author"},[t._v("作者："),e("el-input",{staticClass:"a-input",attrs:{type:"text",placeholder:"作者"},model:{value:t.data.author,callback:function(a){t.$set(t.data,"author",a)},expression:"data.author"}})],1),t._v(" "),e("div",{staticClass:"a-item a-cover"},[t._v("封面： \n        "),e("el-upload",{staticClass:"a-input avatar-uploader",attrs:{action:t.domain,"http-request":t.upqiniu,"show-file-list":!1,"before-upload":t.beforeUpload}},[t.imageUrl?e("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),e("div",{staticClass:"a-item a-type"},[t._v("类型："),e("el-input",{staticClass:"a-input",attrs:{type:"number",placeholder:"1公告2攻略3数据"},model:{value:t.data.type,callback:function(a){t.$set(t.data,"type",a)},expression:"data.type"}})],1),t._v(" "),e("div",{staticClass:"a-item a-banner"},[t._v("是否为banner：\n        "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.banner,expression:"data.banner"}],attrs:{type:"radio",id:"i-one",value:"0"},domProps:{checked:t._q(t.data.banner,"0")},on:{change:function(a){t.$set(t.data,"banner","0")}}}),t._v(" "),e("label",{attrs:{for:"i-one"}},[t._v("否")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.banner,expression:"data.banner"}],attrs:{type:"radio",id:"i-two",value:"1"},domProps:{checked:t._q(t.data.banner,"1")},on:{change:function(a){t.$set(t.data,"banner","1")}}}),t._v(" "),e("label",{attrs:{for:"i-two"}},[t._v("是")])]),t._v(" "),e("div",{staticClass:"a-item a-goto"},[t._v("跳转path："),e("el-input",{staticClass:"a-input",attrs:{type:"text",placeholder:"path"},model:{value:t.data.goto,callback:function(a){t.$set(t.data,"goto",a)},expression:"data.goto"}})],1),t._v(" "),e("div",{staticClass:"a-item a-top"},[t._v("排序："),e("el-input",{staticClass:"a-input",attrs:{type:"number",placeholder:"默认0，数值越大越前"},model:{value:t.data.top,callback:function(a){t.$set(t.data,"top",a)},expression:"data.top"}})],1),t._v(" "),e("vue-html5-editor",{ref:"editor",staticClass:"a-content",attrs:{content:t.data.content,height:500,"auto-height":!0,"z-index":1e3},on:{change:t.updateData}})],1)])},staticRenderFns:[]};var c=e("VU/8")(d,r,!1,function(t){e("93yl")},"data-v-7356b747",null).exports,u=e("viA7"),p={mixins:[e("F4+m").a],data:function(){var t=this;return{data:[],udata:{},isAdd:!0,titles:[{prop:"title",label:"标题"},{prop:"type",label:"类"},{prop:"top",label:"序"}],isOpenAdd:!1,filters:[{prop:"title",value:""}],actionCol:{props:{label:"操作"},buttons:[{handler:function(a){t.update(a)},label:"编辑"},{handler:function(a){t.delete(a)},label:"删除"}]},selectedRow:[]}},created:function(){this._getAllArticleList()},mounted:function(){this.checkToken()},methods:{_getAllArticleList:function(){var t=this,a={token:this.token};Object(u.c)(a).then(function(a){t.data=a})},openAdd:function(){this.isOpenAdd=!0,this.udata={},this.isAdd=!0},submit:function(t){var a=this;this.isAdd?(t.token=this.token,Object(u.a)(t).then(function(e){console.log(e),a.isOpenAdd=!1,a.$message("添加成功！"),a.data.unshift(t)})):(console.log(t),t.token=this.token,Object(u.i)(t).then(function(t){console.log(t),t.ok?(a.isOpenAdd=!1,a.$message("修改成功！")):that.$message("修改失败！")}))},quit:function(){this.isOpenAdd=!1},delete:function(t){var a=this,e={id:t._id,token:this.token};Object(u.b)(e).then(function(e){e.ok&&(a.data.splice(a.data.indexOf(t),1),a.$message("删除成功！"))})},update:function(t){this.isOpenAdd=!0,this.isAdd=!1,this.udata=t},width:function(t){if("title"!==t)return 60},handleSelectionChange:function(t){this.selectedRow=t}},components:{ArticleAdd:c,Scroll:l.a}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{ref:"article",staticClass:"article"},[e("div",[e("div",{staticClass:"article-head"},[t._v("文章管理")]),t._v(" "),e("div",{staticStyle:{margin:"10px 0"}},[e("el-row",[e("el-col",{staticStyle:{margin:"0 10px"},attrs:{span:8}},[e("el-input",{attrs:{placeholder:"文章搜索"},model:{value:t.filters[0].value,callback:function(a){t.$set(t.filters[0],"value",a)},expression:"filters[0].value"}})],1),t._v(" "),e("el-col",{staticStyle:{margin:"0 15px"},attrs:{span:5}},[e("el-button",{on:{click:t.openAdd}},[t._v("添加")])],1)],1)],1),t._v(" "),e("data-tables",{staticClass:"data-table",staticStyle:{width:"100%"},attrs:{data:t.data,"current-page":3,"page-size":5,"pagination-props":{background:!1,small:!0,layout:"prev, pager, next",pageSizes:[6,1,3]},"action-col":t.actionCol,filters:t.filters},on:{"selection-change":t.handleSelectionChange}},t._l(t.titles,function(a){return e("el-table-column",{key:a.prop,attrs:{prop:a.prop,label:a.label,sortable:"custom",width:t.width(a.prop)}})})),t._v(" "),t.isOpenAdd?e("article-add",{attrs:{udata:t.udata},on:{quit:t.quit,submit:t.submit}}):t._e()],1)])},staticRenderFns:[]};var v=e("VU/8")(p,h,!1,function(t){e("FC6f")},"data-v-4f84d2fa",null);a.default=v.exports},AKgy:function(t,a,e){var i=e("EqjI"),n=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&n(t)===t}},FC6f:function(t,a){},"RRo+":function(t,a,e){t.exports={default:e("c45H"),__esModule:!0}},c45H:function(t,a,e){e("1alW"),t.exports=e("FeBl").Number.isInteger}});